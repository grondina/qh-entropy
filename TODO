* Refactor the code and make styles consistent.

* Better error checking.

* Test for different kinds of molecules.
